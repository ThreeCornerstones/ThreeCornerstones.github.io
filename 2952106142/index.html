<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="3whzDzMZQfOd_VJLLPYTteRTeTCb8rD5hDhMxa50HcA">
  <meta name="baidu-site-verification" content="code-42fMxbMiHJ">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script data-ad-client="ca-pub-6209064810244468" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"threecornerstones.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"valine","storage":true,"lazyload":false,"nav":null,"activeClass":"valine"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="MVC在iOS编程中非常常见，因为这是苹果在UIKit中选择采用的设计模式。 允许控制器为他们的模型和视图提供强大的属性，因此他们可以可直接访问。控制器可以有一个以上的模型和&#x2F;或视图。 相反，模型和视图不应持有对其所属控制器的强引用。这将导致一个保留循环。 相反，模型通过属性观察（您将在后面的章节中深入了解）与控制器通信，而视图通过IBActions与控制器通信。 这让您可以在多个控制器之间重用模">
<meta property="og:type" content="article">
<meta property="og:title" content="Design Patterns 第3章：模型-视图-控制器(MVC)模式">
<meta property="og:url" content="https://threecornerstones.github.io/2952106142/index.html">
<meta property="og:site_name" content="三大基石">
<meta property="og:description" content="MVC在iOS编程中非常常见，因为这是苹果在UIKit中选择采用的设计模式。 允许控制器为他们的模型和视图提供强大的属性，因此他们可以可直接访问。控制器可以有一个以上的模型和&#x2F;或视图。 相反，模型和视图不应持有对其所属控制器的强引用。这将导致一个保留循环。 相反，模型通过属性观察（您将在后面的章节中深入了解）与控制器通信，而视图通过IBActions与控制器通信。 这让您可以在多个控制器之间重用模">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/AvvEPs.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/lw0FSD.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/Dd6NX0.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/y69sUS.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/HiRcds.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/WPwpKe.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/4qTuLw.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/T3iw2c.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/dzYWMu.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/QwswZP.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/9qOPOl.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/oLoAh5.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/FOyzxX.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/NwMyY5.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/i7cncV.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/WRfVYd.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/2J5RcD.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/2KnnED.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/LkSD3h.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/7qb440.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/ICs22G.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/zgXH1U.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/jreoyj.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/4wdm04.png">
<meta property="og:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/FydJEg.png">
<meta property="article:published_time" content="2020-11-21T05:45:53.000Z">
<meta property="article:modified_time" content="2020-11-21T09:38:18.027Z">
<meta property="article:author" content="gege">
<meta property="article:tag" content="编程">
<meta property="article:tag" content="设计模式">
<meta property="article:tag" content="Design Patterns by Tutorials 2nd Edition 2">
<meta property="article:tag" content="[object Object]">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/AvvEPs.png">

<link rel="canonical" href="https://threecornerstones.github.io/2952106142/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Design Patterns 第3章：模型-视图-控制器(MVC)模式 | 三大基石</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3SD2RPZVHR"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3SD2RPZVHR');
      }
    </script>


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?8ebf8d52b06d27d3ee34d5144b07d5b6";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>


  <script>
    !function(e,t,n,g,i){e[i]=e[i]||function(){(e[i].q=e[i].q||[]).push(arguments)},n=t.createElement("script"),tag=t.getElementsByTagName("script")[0],n.async=1,n.src=('https:'==document.location.protocol?'https://':'http://')+g,tag.parentNode.insertBefore(n,tag)}(window,document,"script","assets.growingio.com/2.1/gio.js","gio");
    gio('init', '989f2bfc0870b471', {});
    gio('send');
  </script>


  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="三大基石" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">三大基石</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-books">

    <a href="/books/" rel="section"><i class="fa fa-th fa-fw"></i>阅读</a>

  </li>
        <li class="menu-item menu-item-movies">

    <a href="/movies/" rel="section"><i class="fa fa-th fa-fw"></i>电影</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>站点地图</a>

  </li>
        <li class="menu-item menu-item-commonweal">

    <a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/ThreeCornerstones" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://threecornerstones.github.io/2952106142/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="gege">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="三大基石">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Design Patterns 第3章：模型-视图-控制器(MVC)模式
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-11-21 13:45:53 / 修改时间：17:38:18" itemprop="dateCreated datePublished" datetime="2020-11-21T13:45:53+08:00">2020-11-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2952106142/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2952106142/" itemprop="commentCount"></span>
    </a>
  </span>
  
  <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>11k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>10 分钟</span>
            </span>
            <div class="post-description">MVC在iOS编程中非常常见，因为这是苹果在UIKit中选择采用的设计模式。
允许控制器为他们的模型和视图提供强大的属性，因此他们可以可直接访问。控制器可以有一个以上的模型和/或视图。
相反，模型和视图不应持有对其所属控制器的强引用。这将导致一个保留循环。
相反，模型通过属性观察（您将在后面的章节中深入了解）与控制器通信，而视图通过IBActions与控制器通信。
这让您可以在多个控制器之间重用模型和视图。赢了!</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>模型-视图-控制器(MVC)模式将对象分为三种不同的类型。是的，你猜对了：这三种类型是：模型、视图和控制器!</p>
<p>用下图来解释这些类型之间的关系相当简单。<br><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/AvvEPs.png" alt="AvvEPs"></p>
<p>• （Models）模型保存应用数据。它们通常是结构或简单的类。<br>• （View）视图在屏幕上显示视觉元素和控件。它们通常是UIView的子类。<br>• （Controllers）控制器在模型和视图之间进行协调。它们通常是UIViewController的子类。</p>
<p>MVC在iOS编程中非常常见，因为这是苹果在UIKit中选择采用的设计模式。</p>
<p>允许控制器为他们的模型和视图提供强大的属性，因此他们可以可直接访问。控制器可以有一个以上的模型和/或视图。</p>
<p>相反，模型和视图不应持有对其所属控制器的强引用。这将导致一个保留循环。</p>
<p>相反，模型通过属性观察（您将在后面的章节中深入了解）与控制器通信，而视图通过IBActions与控制器通信。</p>
<p>这让您可以在多个控制器之间重用模型和视图。赢了!</p>
<blockquote>
<p>注意：视图可以通过委托对自己的控制器有一个弱引用（见第4章，”委托模式”）。例如，一个UITableView可以为它的委托和/或dataSource引用持有对它自己的视图控制器的弱引用。然而，表视图并不知道这些都是设置给它自己的控制器的–它们只是碰巧是这样。</p>
</blockquote>
<p>控制器更难重用，因为它们的逻辑通常对它们所做的任何任务都非常特殊。因此，MVC并没有尝试重用它们。</p>
<h3 id="3-1-什么时候该用？"><a href="#3-1-什么时候该用？" class="headerlink" title="3.1 什么时候该用？"></a>3.1 什么时候该用？</h3><h3 id="3-2-操场实例"><a href="#3-2-操场实例" class="headerlink" title="3.2 操场实例"></a>3.2 操场实例</h3><p>打开Starter目录下的FundamentalDesignPatterns.xcworkspace。这是一个游乐场页面的集合，每个基本设计模式都有一个页面。在本节结束时，你会有一个很好的设计模式参考!</p>
<p>从 “文件 “层次结构打开 “概览 “页面。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/lw0FSD.png" alt="lw0FSD"></p>
<p>本页列出了三种类型的设计模式。<br>• 结构模式描述了对象如何组成更大的子系统。<br>• 行为模式描述了对象之间如何通信。<br>• 创建模式为您实例化或 “创建 “对象。</p>
<p>MVC是一种结构模式，因为它就是把对象组成模型、视图或控制器。</p>
<p>接下来，从 “文件 “层次结构中打开 “模型-视图-控制器 “页面。在代码示例中，你将使用MVC创建一个 “地址屏幕”。</p>
<p>你能猜到地址屏的三个部分会是什么吗？当然是模型、视图和控制器! 在Code Example之后添加这段代码来创建模型。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="comment">// MARK: - Address</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> street: <span class="type">String</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> city: <span class="type">String</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> state: <span class="type">String</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> zipCode: <span class="type">String</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样就创建了一个简单的结构，表示一个地址。</p>
<p>接下来需要导入UIKit来创建AddressView作为UIView的子类。</p>
<p>加入这段代码即可。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - AddressView</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AddressView</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">  <span class="meta">@IBOutlet</span> <span class="keyword">public</span> <span class="keyword">var</span> streetTextField: <span class="type">UITextField!</span></span><br><span class="line">  <span class="meta">@IBOutlet</span> <span class="keyword">public</span> <span class="keyword">var</span> cityTextField: <span class="type">UITextField!</span></span><br><span class="line">  <span class="meta">@IBOutlet</span> <span class="keyword">public</span> <span class="keyword">var</span> stateTextField: <span class="type">UITextField!</span></span><br><span class="line">  <span class="meta">@IBOutlet</span> <span class="keyword">public</span> <span class="keyword">var</span> zipCodeTextField: <span class="type">UITextField!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在实际的iOS应用中，而不是游乐场，你还会为这个视图创建一个xib或故事板，并将IBOUTLET属性连接到它的子视图。在本章的教程项目中，你会在后面练习这样做。</p>
<p>最后，你需要创建AddressViewController。接下来添加这段代码。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - AddressViewController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">AddressViewController</span>: <span class="title">UIViewController</span> </span>&#123;</span><br><span class="line"><span class="comment">// MARK: - Properties</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> address: <span class="type">Address?</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">var</span> addressView: <span class="type">AddressView!</span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> isViewLoaded <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">    <span class="keyword">return</span> (view <span class="keyword">as</span>! <span class="type">AddressView</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在这里，你让控制器持有对它所拥有的视图和模型的强引用。</p>
<p>addressView是一个计算属性，因为它只有一个getter。它首先检查isViewLoaded，以防止在视图控制器呈现在屏幕上之前创建视图。如果isViewLoaded为真，它就会将视图投射到一个AddressView上。为了使警告保持沉默，你用括号包围这个投射。</p>
<p>在实际的iOS应用中，你还需要在storyboard或xib上指定视图的类，以确保应用正确地创建一个AddressView而不是默认的UIView。</p>
<p>回顾一下，控制器的责任是协调模型和视图之间的关系。在这种情况下，控制器应该使用来自地址的值更新其地址View。</p>
<p>一个很好的地方是每当调用viewDidLoad的时候。在AddressViewController类的末尾添加以下内容。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - View Lifecycle</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123; </span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">    updateViewFromAddress()</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">updateViewFromAddress</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> addressView = addressView,</span><br><span class="line"><span class="keyword">let</span> address = address <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125; </span><br><span class="line">    </span><br><span class="line">    addressView.streetTextField.text = address.street 	</span><br><span class="line">    addressView.cityTextField.text = address.city </span><br><span class="line">    addressView.stateTextField.text = address.state </span><br><span class="line">    addressView.zipCodeTextField.text = address.zipCode</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果在调用viewDidLoad后设置了地址，控制器也应该更新地址View。</p>
<p>将地址属性替换为以下内容。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> address: <span class="type">Address?</span> &#123;</span><br><span class="line">  <span class="keyword">didSet</span> &#123;</span><br><span class="line">    updateViewFromAddress()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这是个例子，说明模型如何告诉控制器有什么变化，视图需要更新。</p>
<p>如果你也想让用户从视图中更新地址呢？没错–你需要在控制器上创建一个IBAction。</p>
<p>在 updateViewFromAddress()之后添加这个。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - Actions</span></span><br><span class="line"><span class="meta">@IBAction</span> <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">updateAddressFromView</span><span class="params">( <span class="number">_</span> sender: AnyObject)</span></span> &#123;</span><br><span class="line">	<span class="keyword">guard</span> <span class="keyword">let</span> street = addressView.streetTextField.text, street.<span class="built_in">count</span> &gt; <span class="number">0</span>,</span><br><span class="line">	<span class="keyword">let</span> city = addressView.cityTextField.text, city.<span class="built_in">count</span> &gt; <span class="number">0</span>,</span><br><span class="line">	<span class="keyword">let</span> state = addressView.stateTextField.text, state.<span class="built_in">count</span> &gt; <span class="number">0</span>,</span><br><span class="line">	<span class="keyword">let</span> zipCode = addressView.zipCodeTextField.text, zipCode.<span class="built_in">count</span> &gt; <span class="number">0</span> <span class="keyword">else</span> &#123;</span><br><span class="line">	<span class="comment">// TO-DO: show an error message, handle the error, etc</span></span><br><span class="line">	<span class="keyword">return</span></span><br><span class="line">  &#125;</span><br><span class="line">  address = <span class="type">Address</span>(street: street, city: city,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后，这是一个例子，说明视图如何告诉控制器有什么变化，模型需要更新。在实际的iOS应用中，你还需要从AddressView的子视图中连接这个IBAction，比如UITextField上的valueChanged事件或者UIButton上的touchUpInside事件。</p>
<p>总而言之，这给了你一个简单的例子，让你了解MVC模式是如何工作的。你已经看到了控制器如何拥有模型和视图，以及每个模型和视图如何相互交互，但总是通过控制器。</p>
<h3 id="3-3-你应该注意什么？"><a href="#3-3-你应该注意什么？" class="headerlink" title="3.3 你应该注意什么？"></a>3.3 你应该注意什么？</h3><p>MVC是一个很好的起点，但它有局限性。并非每个对象都能整齐地归入模型、视图或控制器的范畴。因此，只使用MVC的应用程序往往会在控制器中加入大量的逻辑。这可能导致视图控制器变得非常大! 当这种情况发生时，有一个相当古怪的术语，叫做 “大规模视图控制器”。(汶：MVC使用会出现的问题)</p>
<p>为了解决这个问题，你应该根据你的应用需要引入其他设计模式。</p>
<h3 id="3-4-教程项目"><a href="#3-4-教程项目" class="headerlink" title="3.4 教程项目"></a>3.4 教程项目</h3><p>在本节中，你将创建一个名为Rabble Wabble的教程应用。</p>
<p>这是一款语言学习应用，类似于Duolingo (<a target="_blank" rel="noopener" href="http://bit.ly/ios-duolingo)%E3%80%81WaniKani%E7%AD%89%E3%80%82(http://bit.ly/wanikani)">http://bit.ly/ios-duolingo)、WaniKani等。(http://bit.ly/wanikani)</a> 和 Anki (<a target="_blank" rel="noopener" href="http://bit.ly/ios-anki)%E3%80%82">http://bit.ly/ios-anki)。</a></p>
<p>你将从头开始创建项目，所以打开Xcode并选择File ▸ New ▸。项目。然后选择iOS ▸单一视图应用程序，并按下一步。</p>
<p>输入RabbleWabble作为产品名称；选择你的团队，如果你没有设置团队，则保留为 “无”（如果你只使用模拟器，则不需要）；将你的组织名称和组织标识符设置为你喜欢的任何内容；确认语言设置为Swift；取消选中使用核心数据、包含单元测试和包含UI测试；然后点击 “下一步 “继续。</p>
<p>选择一个方便的位置来保存项目，然后按Create。你需要做一些组织工作来展示MVC模式。</p>
<p>从File hierarchy中打开ViewController.swift，删除大括号内的所有模板代码。然后右击ViewController，选择Refactor ▸ 重命名….。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/Dd6NX0.png" alt="Dd6NX0"></p>
<p>输入QuestionViewController作为新的名称，然后按Enter键进行修改。然后，在类QuestionViewController前添加关键字public，像这样。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuestionViewController</span>: <span class="title">UIViewController</span></span></span><br></pre></td></tr></table></figure>

<p>在本书中，对于那些应该被其他类公开访问的类型、属性和方法，你会使用public；如果某些东西只应该被类型本身访问，你会使用private；如果它应该被子类或相关类访问，但不打算供一般使用，你会使用internal。这就是所谓的访问控制。</p>
<p>这是iOS开发中的 “最佳实践”。如果你曾经将这些文件移动到一个单独的模块中，例如创建一个共享的库或框架，你会发现如果你遵循这个最佳实践，你会发现它更容易做到。</p>
<p>接下来，在 “文件 “层次结构中选择黄色的RabbleWabble组，然后一起按Command + Option + N键创建一个新组。<br>选择新组，按Enter键编辑其名称。输入AppDelegate，再按Enter键确认。</p>
<p>重复此过程，为控制器、模型、资源和视图创建新组。</p>
<p>将 AppDelegate.swift 移入 AppDelegate 组，将 QuestionViewController.swift 移入控制器，将 Assets.xcassets 和 Info.plist 移入资源，将 LaunchScreen.storyboard 和 Main.storyboard 移入视图。</p>
<p>最后，右键单击黄色的RabbleWabble组，选择按名称排序。</p>
<p>你的文件层次结构最终应该是这样的。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/y69sUS.png" alt="y69sUS"></p>
<p>由于您移动了Info.plist，您需要告诉Xcode它的新位置在哪里。要做到这一点，选择蓝色的RabbleWabble项目文件夹；选择RabbleWabble目标，选择General选项卡，然后点击Choose Info.plist File….。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/HiRcds.png" alt="HiRcds"></p>
<p>在出现的新窗口中，从文件列表中点击Info.plist，然后按Choose设置。构建并运行以验证你在Xcode中没有看到任何错误。</p>
<p>这是使用MVC模式的一个好的开始！通过简单地将你的文件分组，你可以在Xcode中看到任何错误。通过简单地以这种方式对文件进行分组，您就可以告诉其他开发人员您的项目使用了MVC。清晰是好事</p>
<h3 id="3-5-创建模型"><a href="#3-5-创建模型" class="headerlink" title="3.5 创建模型"></a>3.5 创建模型</h3><p>接下来你将创建Rabble Wabble的模型。</p>
<p>首先，你需要创建一个问题模型。在 “文件 “层次结构中选择 “模型 “组，然后按Command + N创建一个新文件。从列表中选择Swift文件，然后点击 “下一步”。将文件命名为Question.swift，然后单击 “创建”。</p>
<p>用以下内容替换Question.swift的全部内容。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">Question</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">let</span> answer: <span class="type">String</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">let</span> hint: <span class="type">String?</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">let</span> prompt: <span class="type">String</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>您还需要另一个模型来充当问题组的容器。</p>
<p>在模型组中创建另一个名为QuestionGroup.swift的文件，并将其全部内容替换为以下内容。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">QuestionGroup</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">let</span> questions: [<span class="type">Question</span>]</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">let</span> title: <span class="type">String</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，您需要添加问题群的数据。这可能需要重新打字，所以我提供了一个文件，您可以简单地拖放到项目中。</p>
<p>打开Finder并导航到你下载本章项目的地方。在Starter和Final目录旁边，你会看到一个Resources目录，其中包含QuestionGroupData.swift、Assets.xcassets和LaunchScreen.storyboard。</p>
<p>将Finder窗口定位在Xcode上方，然后像这样将QuestionGroupData.swift拖放到Models组中。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/WPwpKe.png" alt="WPwpKe"></p>
<p>提示时，如果需要，请选中复制项目的选项，然后按完成添加文件。</p>
<p>既然你已经打开了Resources目录，那么你应该把其他文件也复制过来。首先，在应用程序中选择资源下现有的Assets.xcassets，按Delete键删除。在提示时选择 “移动到回收站”。然后，将新的Assets.xcassets从Finder拖放到应用程序的资源组中，如果需要，在提示时勾选复制项目。</p>
<p>接下来，选择应用中现有的LaunchScreen.storyboard在Views下，按Delete键将其删除。同样，确保在提示时选择 “移动到垃圾桶”。然后，将新的LaunchScreen.storyboard从Finder拖放到应用程序的资源组中，如果需要，在提示时勾选复制项目。</p>
<p>打开QuestionGroupData.swift，你会发现里面定义了几个基本短语、数字等静态方法。这个数据集是日文的，但如果你喜欢的话，你可以把它调整为其他语言。你很快就会使用这些方法了</p>
<p>打开LaunchScreen.storyboard，你会看到一个漂亮的布局，每当应用程序启动时就会显示出来。</p>
<p>构建并运行，查看可爱的应用程序图标和启动屏幕!</p>
<h3 id="3-6-创建视图"><a href="#3-6-创建视图" class="headerlink" title="3.6 创建视图"></a>3.6 创建视图</h3><p>现在你需要设置MVC的 “视图 “部分。选择 “视图 “组，并创建一个名为 “QuestionView.swift “的新文件。</p>
<p>将其内容替换为以下内容。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> UIKit</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">QuestionView</span>: <span class="title">UIView</span> </span>&#123;</span><br><span class="line">  <span class="meta">@IBOutlet</span> <span class="keyword">public</span> <span class="keyword">var</span> answerLabel: <span class="type">UILabel!</span></span><br><span class="line">  <span class="meta">@IBOutlet</span> <span class="keyword">public</span> <span class="keyword">var</span> correctCountLabel: <span class="type">UILabel!</span></span><br><span class="line">  <span class="meta">@IBOutlet</span> <span class="keyword">public</span> <span class="keyword">var</span> incorrectCountLabel: <span class="type">UILabel!</span></span><br><span class="line">  <span class="meta">@IBOutlet</span> <span class="keyword">public</span> <span class="keyword">var</span> promptLabel: <span class="type">UILabel!</span></span><br><span class="line">  <span class="meta">@IBOutlet</span> <span class="keyword">public</span> <span class="keyword">var</span> hintLabel: <span class="type">UILabel!</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来，打开Main.storyboard，滚动到现有场景。按对象库按钮，在搜索栏中输入标签。按住option键防止窗口关闭，然后拖放三个标签到场景上，不要重叠。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/4qTuLw.png" alt="4qTuLw"></p>
<p>按对象库窗口上的红色X，之后关闭窗口。</p>
<p>双击最上面的标签，将其文字设置为 “提示”。将中间的标签设置为 “提示”，将最下面的标签设置为 “答案”。</p>
<p>选择 “提示 “标签，打开 “实用工具 “窗格，选择 “属性 “检查器标签。将标签的字体设置为System 50.0，对齐方式设置为居中，行数设置为0。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/T3iw2c.png" alt="T3iw2c"></p>
<p>将 “提示 “标签的字体设置为系统24.0，对齐方式为居中，行数为0；将 “答案 “标签的字体设置为系统48.0，对齐方式为居中，行数为0。</p>
<p>如果需要，调整标签的大小以防止剪裁，并重新排列它们，使其保持相同的顺序而不重叠。</p>
<p>接下来，选择 “提示 “标签，选择 “添加新约束 “图标，然后进行以下操作。<br>• 设置顶部约束为60<br>• 将前导约束设置为0<br>• 将尾部约束设置为0<br>• 检查对边距的限制<br>• 按 “添加3个约束 “键</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/dzYWMu.png" alt="dzYWMu"></p>
<p>选择 “提示 “标签，选择 “添加新约束 “图标，然后进行以下操作。<br>• 设置顶部约束为8<br>• 将前导约束设置为0<br>• 将尾部约束设置为0<br>• 检查对边距的限制<br>• 按 “添加3个约束 “键</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/QwswZP.png" alt="QwswZP"></p>
<p>选择 “答案 “标签，选择 “添加新约束 “图标，然后进行以下操作。<br>• 将顶部约束设置为50<br>• 将前导约束条件设为0。<br>• 将尾部约束设置为0。<br>• 勾选约束为页边距。<br>• 按 “添加3条约束”。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/9qOPOl.png" alt="9qOPOl"></p>
<p>现在的场景应该是这样的。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/oLoAh5.png" alt="oLoAh5"></p>
<p>接下来，按对象库按钮，在搜索栏中输入UIButton，然后拖动一个新按钮到视图的左下角。</p>
<p>打开 “属性检查器”，将按钮的图片设置为ic_circle_x，并删除按钮的默认标题。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/FOyzxX.png" alt="FOyzxX"></p>
<p>将另一个按钮拖入视图的右下角。将其图像设置为ic_circle_check，并删除Button的默认标题。</p>
<p>拖动一个新的标签到场景中。打开 “属性检查器”，将 “颜色 “设置为与红圈相匹配。将字体设置为System 32.0，并将Alignment设置为居中。根据需要调整此标签的大小，以防止剪切。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/NwMyY5.png" alt="NwMyY5"></p>
<p>拖动另一个标签到场景中，将其放置在绿色复选按钮的下方，并将其文字设置为0。 打开 “属性检查器”，将颜色设置为与绿色圆圈相匹配。将字体设置为System 32.0，并将对齐方式设置为居中。根据需要调整这个标签的大小，以防止剪切。</p>
<p>接下来需要对按钮和标签进行约束设置。</p>
<p>选择红色圆圈按钮，选择 “添加新约束 “图标，然后进行以下操作。<br>• 将前导约束设置为32<br>• 将底部约束条件设置为8。<br>• 勾选约束到页边距。<br>• 按 “添加2个约束”。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/i7cncV.png" alt="i7cncV"></p>
<p>选择红色的标签，选择添加新约束的图标，然后进行以下操作。<br>• 将底部约束设置为24<br>• 勾选约束为页边距。<br>• 按 “添加1条约束”。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/WRfVYd.png" alt="WRfVYd"></p>
<p>同时选择红圈图像视图和红颜色标签，选择对齐的图标，并进行以下操作。<br>• 选中 “水平中心 “的方框。<br>•  按添加1个约束。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/2J5RcD.png" alt="2J5RcD"></p>
<p>选择绿色圆圈图像视图，选择添加新约束的图标，然后进行以下操作。<br>• 设置尾部约束为32。<br>• 将底部约束设置为8。<br>• 勾选约束为页边距。<br>• 按 “添加2个约束 “键</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/2KnnED.png" alt="2KnnED"></p>
<p>选择绿色的标签，选择添加新约束的图标，然后进行以下操作。<br>• 将底部约束设置为24<br>• 勾选约束为页边距。<br>• 按添加1约束。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/LkSD3h.png" alt="LkSD3h"></p>
<p>同时选择绿色圆圈图像视图和绿色颜色标签，选择对齐的图标，并进行以下操作。<br>• 选中 “水平中心 “的方框<br>• 按 “添加1个约束”。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/7qb440.png" alt="7qb440"></p>
<p>现在的场景应该是这样的。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/ICs22G.png" alt="ICs22G"></p>
<p>要完成QuestionView的设置，需要在场景上设置视图的类，并连接属性。</p>
<p>点击场景上的视图，注意不要选择任何子视图代替，打开身份检查器。设置类为QuestionView。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/zgXH1U.png" alt="zgXH1U"></p>
<p>打开 “连接检查器”，并从每个 “出入口 “拖动到适当的子视图，如图所示。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/jreoyj.png" alt="jreoyj"></p>
<p>建好后跑去看看风景。厉害！</p>
<h3 id="3-7-创建控制器"><a href="#3-7-创建控制器" class="headerlink" title="3.7 创建控制器"></a>3.7 创建控制器</h3><p>你终于准备好创建MVC的 “控制器 “部分了。</p>
<p>打开QuestionViewController.swift并添加以下属性。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - Instance Properties</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> questionGroup = <span class="type">QuestionGroup</span>.basicPhrases() <span class="keyword">public</span> <span class="keyword">var</span> questionIndex = <span class="number">0</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> correctCount = <span class="number">0</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> incorrectCount = <span class="number">0</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> questionView: <span class="type">QuestionView!</span> &#123;</span><br><span class="line">  <span class="keyword">guard</span> isViewLoaded <span class="keyword">else</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span> &#125;</span><br><span class="line">  <span class="keyword">return</span> (view <span class="keyword">as</span>! <span class="type">QuestionView</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你暂时把questionGroup硬编码为基本短语。在未来的一章中，您将扩展应用程序，使用户能够从列表中选择问题组。<br>questionIndex是当前显示的问题的索引。当用户浏览问题时，你会递增这个指数。</p>
<p>correctCount是正确回答的次数。用户通过按下绿色的复选按钮来表示一个正确的回答。</p>
<p>同样地，incorrectCount是不正确回答的计数，用户会通过按下红色的X按钮来表示。</p>
<p>问题View是一个计算属性。这里你检查isViewLoaded，这样你就不会因为访问这个属性而导致视图无意中被加载。如果视图已经加载了，你就强制将其转为QuestionView。</p>
<p>接下来你需要添加代码来实际显示一个问题。在刚才添加的属性后添加以下内容。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - View Lifecycle</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123; </span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">  	showQuestion()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">showQuestion</span><span class="params">()</span></span> &#123;</span><br><span class="line">	<span class="keyword">let</span> question = questionGroup.questions[questionIndex]</span><br><span class="line">	questionView.answerLabel.text = question.answer questionView.promptLabel.text = question.prompt 	</span><br><span class="line">  questionView.hintLabel.text = question.hint</span><br><span class="line">	questionView.answerLabel.isHidden = <span class="literal">true</span></span><br><span class="line">  questionView.hintLabel.isHidden = <span class="literal">true</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>请注意这里你是如何在控制器中编写代码来基于模型中的数据来操作视图的。MVC FTW!</p>
<p>构建并运行，看看问题在屏幕上看起来如何!</p>
<p>现在，没有任何方法可以看到答案。你可能应该修复这个问题。在视图控制器的末尾添加以下代码。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MARK: - Actions</span></span><br><span class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">toggleAnswerLabels</span><span class="params">(<span class="number">_</span> sender: <span class="keyword">Any</span>)</span></span> &#123; </span><br><span class="line">    questionView.answerLabel.isHidden =</span><br><span class="line">	!questionView.answerLabel.isHidden questionView.hintLabel.isHidden =</span><br><span class="line">	!questionView.hintLabel.isHidden </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这将切换提示和答案标签是否被隐藏。在showQuestion()中把答案和提示标签设置为隐藏，以在每次显示新问题时重置状态。</p>
<p>这是一个视图通知其控制器有关已发生的操作的例子。作为回应，控制器会执行代码来处理这个动作。</p>
<p>你还需要在视图上挂上这个动作。打开Main.storyboard，按对象库按钮。</p>
<p>在搜索字段中输入tap，然后拖放一个Tap手势识别器到视图上。<br>确保你把它拖到基本视图上，而不是拖到标签或按钮上! 控制-拖拽从 “轻敲手势识别器 “对象到 “问题视图”。</p>
<p>场景中的Controller对象，然后选择toggleAnswerLabels:。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/4wdm04.png" alt="4wdm04"></p>
<p>构建并运行，并尝试点击视图来显示/隐藏答案和提示标签。接下来，你需要处理每当按钮被按下时的情况。</p>
<p>打开QuestionViewController.swift，并在类的末尾添加以下内容。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">handleCorrect</span><span class="params">(<span class="number">_</span> sender: <span class="keyword">Any</span>)</span></span> &#123;</span><br><span class="line">  correctCount += <span class="number">1</span></span><br><span class="line">  questionView.correctCountLabel.text = <span class="string">&quot;\(correctCount)&quot;</span></span><br><span class="line">  showNextQuestion()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="meta">@IBAction</span> <span class="function"><span class="keyword">func</span> <span class="title">handleIncorrect</span><span class="params">(<span class="number">_</span> sender: <span class="keyword">Any</span>)</span></span> &#123;</span><br><span class="line">  incorrectCount += <span class="number">1</span></span><br><span class="line">  questionView.incorrectCountLabel.text = <span class="string">&quot;\(incorrectCount)&quot;</span></span><br><span class="line">  showNextQuestion()</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">showNextQuestion</span><span class="params">()</span></span> &#123;</span><br><span class="line">  questionIndex += <span class="number">1</span></span><br><span class="line">  <span class="keyword">guard</span> questionIndex &lt; questionGroup.questions.<span class="built_in">count</span> <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> - Handle this...!</span></span><br><span class="line"><span class="keyword">return</span></span><br><span class="line">&#125;</span><br><span class="line">  showQuestion()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>你刚刚又定义了三个动作。下面是每个动作的作用。</p>
<p>1.handleCorrect(_:)将在用户按下绿色圆圈按钮时被调用，以表示他们得到了正确的答案。在这里，你增加correctCount并设置correctCountLabel文本。</p>
<p>2.每当用户按下红圈按钮，表示他们得到的答案不正确时，就会调用handleIncorrect(_:)。这里增加incorrectCount并设置incorrectCountLabel文本。</p>
<p>3.调用showNextQuestion()来前进到下一个问题。你根据questionIndex是否小于questionGroup.question.count，来防范是否还有其他问题，如果有，则显示下一个问题。</p>
<p>你将在下一章处理没有问题的情况。最后，你需要将视图上的按钮与这些操作连接起来。</p>
<p>打开Main.storyboard，选择红色圆圈按钮，然后Control-drag到QuestionViewController对象上，选择handleIncorrect:。</p>
<p><img src="https://gitee.com/threecornerstones/ThreeCornerstones_Pic/raw/master/uPic/FydJEg.png" alt="FydJEg"></p>
<p>同样，选择绿色圆圈按钮，然后Control-drag到QuestionViewController对象上，选择handleCorrect:。</p>
<p>再一次，这些都是视图通知控制器需要处理的例子。构建并运行并尝试按下每个按钮。</p>
<h3 id="3-8-关键点"><a href="#3-8-关键点" class="headerlink" title="3.8 关键点"></a>3.8 关键点</h3><p>在本章中，你学习了模型-视图-控制器（MVC）模式。下面是它的关键点。</p>
<p>• MVC将对象分为三类：模型、视图和控制器。<br>• MVC提倡控制器之间重用模型和视图。由于控制器的逻辑通常是非常具体的，所以MVC通常不会重用控制器。<br>• 控制器负责协调模型和视图之间的关系：它将模型的值设置到视图上，并处理来自视图的IBAction调用。<br>• MVC是一个很好的起点，但它也有局限性。并非每个对象都能整齐地归入模型、视图或控制器的范畴。你应该在使用MVC的同时，根据需要使用其他模式。</p>
<p>你已经让Rabble Wabble有了一个很好的开端！不过，你还需要添加很多功能：让用户选择问题组、处理剩余问题时的情况等等。然而，你还有很多功能需要添加：让用户选择问题组，处理没有剩余问题时的情况，以及更多的功能</p>
<p>继续进入下一章，了解授权设计模式，继续构建Rabble Wabble。</p>

    </div>

    
    
    
        <div class="reward-container">
  <div></div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechatpay.png" alt="gege 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.png" alt="gege 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="/images/wechat_channel.png">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%BC%96%E7%A8%8B/" rel="tag"># 编程</a>
              <a href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" rel="tag"># 设计模式</a>
              <a href="/tags/Design-Patterns-by-Tutorials-2nd-Edition-2/" rel="tag"># Design Patterns by Tutorials 2nd Edition 2</a>
              <a href="/tags/object-Object/" rel="tag"># [object Object]</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/4128610484/" rel="prev" title="Design Patterns 第2章：如何阅读类图？">
      <i class="fa fa-chevron-left"></i> Design Patterns 第2章：如何阅读类图？
    </a></div>
      <div class="post-nav-item">
    <a href="/3207717035/" rel="next" title="《研磨设计模式》 第2章 2.1 简单工厂模式-场景问题">
      《研磨设计模式》 第2章 2.1 简单工厂模式-场景问题 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E8%AF%A5%E7%94%A8%EF%BC%9F"><span class="nav-number">1.</span> <span class="nav-text">3.1 什么时候该用？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E6%93%8D%E5%9C%BA%E5%AE%9E%E4%BE%8B"><span class="nav-number">2.</span> <span class="nav-text">3.2 操场实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-%E4%BD%A0%E5%BA%94%E8%AF%A5%E6%B3%A8%E6%84%8F%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-number">3.</span> <span class="nav-text">3.3 你应该注意什么？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-%E6%95%99%E7%A8%8B%E9%A1%B9%E7%9B%AE"><span class="nav-number">4.</span> <span class="nav-text">3.4 教程项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-%E5%88%9B%E5%BB%BA%E6%A8%A1%E5%9E%8B"><span class="nav-number">5.</span> <span class="nav-text">3.5 创建模型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-%E5%88%9B%E5%BB%BA%E8%A7%86%E5%9B%BE"><span class="nav-number">6.</span> <span class="nav-text">3.6 创建视图</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-%E5%88%9B%E5%BB%BA%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="nav-number">7.</span> <span class="nav-text">3.7 创建控制器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-8-%E5%85%B3%E9%94%AE%E7%82%B9"><span class="nav-number">8.</span> <span class="nav-text">3.8 关键点</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">gege</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">159</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">92</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/zh-CN" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">gege</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">237k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">3:36</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> 强力驱动
  </div>
  <div class="addthis_inline_share_toolbox">
    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5fb76326a8ddd0eb" async="async"></script>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

<script src="/js/bookmark.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>




  
<script src="/js/local-search.js"></script>













  

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'NXEpUE5qGFUsFbI6ILpW0CiN-gzGzoHsz',
      appKey     : 'slxX4K58x1eAaR3ifm4jolC1',
      placeholder: "到此一游...",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '5' || 10,
      visitor    : false,
      lang       : 'zh-cn' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
